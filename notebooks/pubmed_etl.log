2025-07-21 02:17:01,802 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:17:01,804 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:17:01,805 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:20:34,506 - INFO - Received command c on object id p0
2025-07-21 02:21:32,922 - INFO - Received command c on object id p0
2025-07-21 02:21:33,327 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:21:33,329 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:21:33,329 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:21:43,593 - INFO - Collected 18772 PMIDs
2025-07-21 02:23:23,784 - INFO - Received command c on object id p0
2025-07-21 02:27:04,773 - INFO - Received command c on object id p0
2025-07-21 02:29:48,797 - INFO - Received command c on object id p0
2025-07-21 02:29:50,002 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:29:50,004 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:29:50,006 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:30:00,059 - INFO - Collected 18772 PMIDs
2025-07-21 02:31:50,851 - INFO - Received command c on object id p0
2025-07-21 02:31:51,660 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:31:51,662 - ERROR - ETL failed with error: [JVM_ATTRIBUTE_NOT_SUPPORTED] Attribute `sparkContext` is not supported in Spark Connect as it depends on the JVM. If you need to use this attribute, do not use Spark Connect when creating your session. Visit https://spark.apache.org/docs/latest/sql-getting-started.html#starting-point-sparksession for creating regular Spark Session in detail.
Traceback (most recent call last):
  File "/home/spark-e0778084-2508-45da-ab10-7e/.ipykernel/16020/command-4642739947525949-383910978", line 499, in run_pubmed_etl
    broadcast_map = spark.sparkContext.broadcast(mesh_mapping)
                    ^^^^^^^^^^^^^^^^^^
  File "/databricks/python/lib/python3.11/site-packages/pyspark/sql/connect/session.py", line 967, in __getattr__
    raise PySparkAttributeError(
pyspark.errors.exceptions.base.PySparkAttributeError: [JVM_ATTRIBUTE_NOT_SUPPORTED] Attribute `sparkContext` is not supported in Spark Connect as it depends on the JVM. If you need to use this attribute, do not use Spark Connect when creating your session. Visit https://spark.apache.org/docs/latest/sql-getting-started.html#starting-point-sparksession for creating regular Spark Session in detail.
2025-07-21 02:33:46,100 - INFO - Received command c on object id p0
2025-07-21 02:33:47,254 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:33:47,256 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:33:47,257 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:33:57,675 - INFO - Collected 18772 PMIDs
2025-07-21 02:38:18,389 - INFO - Received command c on object id p0
2025-07-21 02:38:19,222 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:38:19,225 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:38:19,226 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:38:30,032 - INFO - Collected 18772 PMIDs
2025-07-21 02:39:27,177 - INFO - Received command c on object id p0
2025-07-21 02:39:27,714 - INFO - Starting PubMed ETL with config: ETLConfig(email='mikeandersen622@gmail.com', max_tries=10, sleep_between_tries=20, batch_size=1000, target_count=20000, incremental=False, max_records_per_query=9999)
2025-07-21 02:39:27,715 - INFO - Full run: 2024/07/21 to 2025/07/21
2025-07-21 02:39:27,716 - INFO - Search term: ("Exercise"[MeSH Terms] OR "Physical Conditioning, Human"[MeSH Terms] OR "Resistance Training"[MeSH Terms] OR "Aerobic Exercise"[MeSH Terms] OR "Circuit-Based Exercise"[MeSH Terms] OR "Periodization"[MeSH Terms] OR "Weight Lifting"[MeSH Terms] OR "High-Intensity Interval Training"[MeSH Terms] OR "Plyometric Exercise"[MeSH Terms] OR "Endurance Training"[MeSH Terms] OR "Muscle Stretching Exercises"[MeSH Terms] OR "Physical Fitness"[MeSH Terms] OR "Cardiorespiratory Fitness"[MeSH Terms] OR "Exercise Therapy"[MeSH Terms] OR "Walking"[MeSH Terms] OR "Swimming"[MeSH Terms] OR "Gymnastics"[MeSH Terms] OR "Bicycling"[MeSH Terms]) AND ("2024/07/21"[Date - Publication] : "2025/07/21"[Date - Publication])
2025-07-21 02:39:37,889 - INFO - Collected 18772 PMIDs
2025-07-21 02:42:12,608 - INFO - Extracted 18772 records
2025-07-21 02:43:21,086 - INFO - Saved 16424 records (full refresh)
2025-07-21 02:43:31,865 - INFO - ETL completed successfully: RunMetadata(script_name='pubmed_ingestion', start_time=datetime.datetime(2025, 7, 21, 2, 39, 27, 714505), end_time=datetime.datetime(2025, 7, 21, 2, 43, 31, 865652), incremental_run=False, total_pubs=16424, new_records=16424, status=<ETLStatus.SUCCESS: 'SUCCESS'>, duration_seconds=244.151147)
